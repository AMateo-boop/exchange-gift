<script>
document.addEventListener('DOMContentLoaded', () => {
  let participants = [];

  const addButton = document.getElementById("addButton");
  const confirmButton = document.getElementById("confirmButton");
  const randomButton = document.getElementById("randomButton");

  addButton.addEventListener("click", addEntry);
  confirmButton.addEventListener("click", confirmList);
  randomButton.addEventListener("click", randomize);

  function addEntry() {
    const name = document.getElementById('name').value.trim();
    const codename = document.getElementById('codename').value.trim();
    const wishlist = document.getElementById('wishlist').value.trim();

    if (!name || !codename || !wishlist) {
      alert('Please fill in all fields.');
      return;
    }

    participants.push({ name, codename, wishlist });
    document.getElementById('name').value = '';
    document.getElementById('codename').value = '';
    document.getElementById('wishlist').value = '';
    updateList();
  }

  function updateList() {
    const list = document.getElementById('participantList');
    list.innerHTML = '';
    participants.forEach(p => {
      const li = document.createElement('li');
      li.textContent = ${p.name} (${p.codename}) - Wishlist: ${p.wishlist};
      list.appendChild(li);
    });
  }

  function confirmList() {
    if (participants.length < 2) {
      alert('Add at least 2 participants first.');
      return;
    }
    document.getElementById('randomizer').style.display = 'block';
    alert('List confirmed! You can now randomize your Secret Monito/Monita.');
  }

  function randomize() {
    let receivers = [...participants];
    let results = [];

    for (let giver of participants) {
      let possible = receivers.filter(r => r.name !== giver.name);
      if (possible.length === 0) {
        alert('Re-randomizing to avoid self-pairing.');
        return randomize();
      }
      let receiver = possible[Math.floor(Math.random() * possible.length)];
      results.push(${giver.codename} âžœ ${receiver.codename});
      receivers = receivers.filter(r => r !== receiver);
    }

    const list = document.getElementById('pairList');
    list.innerHTML = '';
    results.forEach(p => {
      const li = document.createElement('li');
      li.textContent = p;
      list.appendChild(li);
    });
  }
});
</script>

</body>
</html>
